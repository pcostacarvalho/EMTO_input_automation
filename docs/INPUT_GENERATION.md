# Input File Generation

## Overview

The `modules/create_input.py` module generates all EMTO input files (KSTR, SHAPE, KGRN, KFCD) from structure dictionaries created by `structure_builder.py`.

## Main Function

### `create_emto_inputs()`

Unified function that generates all EMTO input files for a given structure:

```python
from modules.create_input import create_emto_inputs

create_emto_inputs(
    output_path="./output",
    job_name="fept",
    cif_file="FePt.cif",  # OR use lat, a, sites parameters
    dmax=1.3,
    ca_ratios=[0.96, 1.00, 1.04],
    sws_values=[2.60, 2.65, 2.70],
    magnetic='F'
)
```

## Input File Types

### KSTR (Structure)
- Defines crystal structure and atomic positions
- Generated by `modules/inputs/kstr.py`
- Contains: LAT, NQ3, BSX/BSY/BSZ, fractional coordinates

### SHAPE (Shape Functions)
- Defines shape functions for muffin-tin approximation
- Generated by `modules/inputs/shape.py`
- Contains: NQ3, shape function parameters

### KGRN (Green's Function)
- Main electronic structure calculation input
- Generated by `modules/inputs/kgrn.py`
- Contains: atom data (IQ, IT, ITA, concentrations), magnetic moments, k-mesh

### KFCD (Charge Density)
- Charge density calculation input
- Generated by `modules/inputs/kfcd.py`
- Contains: reference to KGRN calculation

## Directory Structure

```
output_path/
├── smx/                    # KSTR input files
│   └── jobname_ratio.dat
├── shp/                    # SHAPE input files
│   └── jobname_ratio.dat
├── pot/                    # Potential directory
├── chd/                    # Charge density directory
├── fcd/                    # KFCD input files
│   └── jobname_ratio_sws.dat
├── tmp/                    # Temporary files
├── jobname_ratio_sws.dat  # KGRN input files
└── run_jobname.sh         # SLURM job script
```

## Features

- **Unified workflow**: Works with both CIF and parameter-based structures
- **Multiple c/a ratios**: Generates inputs for each c/a ratio
- **Multiple SWS values**: Generates inputs for each SWS value
- **Job script generation**: Creates SLURM scripts for HPC clusters
- **DMAX optimization**: Optional automatic cutoff distance optimization

## Integration

- Uses `structure_builder.py` to create structure dictionaries
- Uses `modules/inputs/` submodules for individual file generation
- Integrated into `optimization_workflow.py` for automated workflows

## Related Modules

- `modules/structure_builder.py`: Structure creation
- `modules/inputs/kstr.py`: KSTR file generation
- `modules/inputs/kgrn.py`: KGRN file generation
- `modules/inputs/shape.py`: SHAPE file generation
- `modules/inputs/kfcd.py`: KFCD file generation
- `modules/inputs/jobs_tetralith.py`: SLURM script generation
